# Physics Audit Report
**Date:** 2026-01-22
**Auditor:** PHYSICS AUDITOR (Jules)
**Focus Area:** Core Physics, Ball Flight, Equipment, Biomechanics

## Executive Summary

The physics implementation demonstrates a solid foundation in biomechanics (Hill-type muscle models) and basic ball flight dynamics (RK4 solver with drag/lift). However, **critical gaps** exist in the ball flight simulation (missing spin decay) and equipment modeling (simplified shaft dynamics and impact physics) that significantly limit the fidelity of the simulation for professional-grade analysis.

- **Overall Physics Fidelity Score:** 6/10
- **Critical Issues Count:** 1 (Ball Spin Decay)
- **High Priority Issues Count:** 3 (Shaft Frequency, Impact MOI, Gear Effect)
- **Confidence in Results:** High. Code analysis explicitly confirms missing or simplified logic in identified areas.

## Findings by Category

### 1. Mathematical Correctness

#### **CRITICAL: Missing Ball Spin Decay**
- **File:** `shared/python/ball_flight_physics.py`:130-360 (`_flight_dynamics_core`)
- **Issue:** The flight dynamics integration loop treats angular velocity (`omega`) as a constant throughout the trajectory. While `SPIN_DECAY_RATE_S` is defined in `physics_constants.py`, it is unused in the solver.
- **Expected Physics:** Golf ball spin decays exponentially during flight due to viscous torque ($$\omega(t) = \omega_0 e^{-kt}$$). This significantly affects lift and drag late in the trajectory.
- **Actual Implementation:** Constant spin rate used for entire flight.
- **Impact:** **Severe**. Overestimates carry distance and curvature (Magnus effect) for long shots (drivers), as high initial spin is maintained artificially.
- **Recommended Fix:** Implement spin decay in `_flight_dynamics_core`. Differential equation: $$d\omega/dt = -k \omega$$.

#### **Incorrect Natural Frequency for Tapered Shafts**
- **File:** `shared/python/flexible_shaft.py`:430-440 (`ModalShaftModel.initialize`)
- **Issue:** Natural frequency calculation uses the formula for a uniform cantilever beam ($$\omega_n = \beta_n^2 \sqrt{EI/(\mu L^4)}$$) using *average* EI and mass properties.
- **Expected Physics:** Golf shafts are tapered, with EI varying by factor of >2 along the length. Using averages for a highly non-uniform beam yields incorrect frequencies.
- **Actual Implementation:** Uses `np.mean(EI)` and `np.mean(mass)`.
- **Impact:** **High**. Incorrect shaft timing and "kick" feel. Frequency could be off by 10-20%.
- **Recommended Fix:** Use Rayleigh-Ritz method or FEA (already stubbed) to compute eigenfrequencies for the specific tapered profile.

### 2. Physical Plausibility

#### **Oversimplified Club-Ball Impact (Solid Sphere MOI)**
- **File:** `shared/python/impact_model.py`:33
- **Issue:** `GOLF_BALL_MOMENT_INERTIA` is calculated as $$2/5 \cdot M \cdot R^2$$ (solid uniform sphere).
- **Expected Physics:** Modern golf balls have a dense core and lighter mantle/cover, or vice versa, resulting in an MOI different from a solid sphere (typically lower, $$I \approx 0.38-0.4 MR^2$$ depending on construction).
- **Actual Implementation:** Hardcoded solid sphere formula.
- **Impact:** **Medium**. Affects spin generation and transfer efficiency.
- **Recommended Fix:** Allow configurable MOI factor (e.g., $$0.4 \cdot M \cdot R^2$$) or use specific ball construction data.

#### **Heuristic Gear Effect Model**
- **File:** `shared/python/impact_model.py`:500-530 (`compute_gear_effect_spin`)
- **Issue:** Gear effect spin is calculated using a linear heuristic (`-gear_factor * offset * speed`).
- **Expected Physics:** Gear effect arises from the torque generated by the offset impact acting on the clubhead's MOI (around its CG), causing head rotation and localized slip/gear-meshing at the interface.
- **Actual Implementation:** Empirical linear approximation.
- **Impact:** **Medium/High**. Reduced accuracy for off-center hits, critical for forgiveness analysis.
- **Recommended Fix:** Implement full rigid body collision dynamics including Clubhead MOI tensor and CG location relative to face center.

### 3. Biomechanics Accuracy

- **Status:** **Good**.
- **Observation:** `shared/python/hill_muscle.py` correctly implements active force-length, force-velocity (Hill's hyperbola), and passive elastic components.
- **Observation:** `shared/python/ground_reaction_forces.py` correctly implements COP and impulse calculations, though assumes flat ground.

### 4. Ball Flight Physics

#### **Missing Wind Gradient**
- **File:** `shared/python/ball_flight_physics.py`
- **Issue:** Wind is modeled as a constant vector field.
- **Expected Physics:** Wind speed increases with altitude (boundary layer profile).
- **Impact:** **Low/Medium**. Slight inaccuracy in apex trajectory wind effects.
- **Recommended Fix:** Implement power-law or logarithmic wind profile.

### 5. Equipment Models

#### **Flexible Shaft Model**
- **Status:** **Mixed**.
- **Observation:** `ModalShaftModel` uses a static cantilever deflection shape ($$x^2(3-2x)$$) as the first mode shape. While a reasonable approximation for the first mode, it is not the true dynamic eigenmode of a tapered shaft.
- **Issue:** Load application in `apply_load` uses an arbitrary scaling factor `1e-6` and `np.linalg.norm(force)`, ignoring force directionality relative to the mode shape.

### 6. Statistical Methods

#### **Dimensionless Jerk Definition**
- **File:** `shared/python/statistical_analysis.py`:1460
- **Issue:** Calculates dimensionless jerk as `peak_jerk / peak_acc`.
- **Expected Physics:** Standard dimensionless jerk involves duration and amplitude scaling (e.g., $$\int j^2 dt \cdot D^5 / A^2$$).
- **Impact:** **Low**. Metric may not be comparable to literature standard values.

## Validation Recommendations

### Test Cases Needed
1.  **Spin Decay Verification:** Compare simulated trajectory of a high-spin drive (3000 rpm) vs low-spin drive (2000 rpm) against empirical tables (e.g., TrackMan). Verify spin at landing < spin at launch.
2.  **Shaft Frequency:** Compare `ModalShaftModel` computed frequency against the analytical solution for a standard tapered beam (Kirchhoff beam equation).
3.  **Conservation of Energy:** Validate `ImpactModel` energy loss exactly matches $$1 - COR^2$$ (plus friction losses).

### Real-World Data Validation
- **Ball Flight:** Validate against TrackMan "Optimal Launch" charts.
- **Shaft:** Validate static deflection profiles against EI profiles from shaft databases (e.g., CoolClubs/Miya data).

## Citations Needed
- **Ball Flight:** Penner, A.R. (2003) "The physics of golf".
- **Aerodynamics:** Bearman, P.W., & Harvey, J.K. (1976) "Golf ball aerodynamics".
- **Muscle Model:** Hill, A.V. (1938) "The Heat of Shortening...".
- **Impact:** Cochran, A., & Stobbs, J. (1968) "Search for the Perfect Swing".
