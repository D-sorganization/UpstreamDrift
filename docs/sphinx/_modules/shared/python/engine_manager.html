

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>shared.python.engine_manager &mdash; Golf Modeling Suite 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Golf Modeling Suite
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/shared.html">Shared Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/engines.html">Physics Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/launchers.html">Launchers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Golf Modeling Suite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">shared.python.engine_manager</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for shared.python.engine_manager</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Engine Manager for Golf Modeling Suite.</span>

<span class="sd">This module provides unified management of different physics engines</span>
<span class="sd">including MuJoCo, Drake, Pinocchio, OpenSim, MATLAB models, and pendulum models.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.common_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">GolfModelingError</span><span class="p">,</span> <span class="n">setup_logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.interfaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhysicsEngine</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">setup_logging</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="EngineType">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineType">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EngineType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Available physics engine types.&quot;&quot;&quot;</span>

    <span class="n">MUJOCO</span> <span class="o">=</span> <span class="s2">&quot;mujoco&quot;</span>
    <span class="n">DRAKE</span> <span class="o">=</span> <span class="s2">&quot;drake&quot;</span>
    <span class="n">PINOCCHIO</span> <span class="o">=</span> <span class="s2">&quot;pinocchio&quot;</span>
    <span class="n">OPENSIM</span> <span class="o">=</span> <span class="s2">&quot;opensim&quot;</span>
    <span class="n">MYOSIM</span> <span class="o">=</span> <span class="s2">&quot;myosim&quot;</span>
    <span class="n">MATLAB_2D</span> <span class="o">=</span> <span class="s2">&quot;matlab_2d&quot;</span>
    <span class="n">MATLAB_3D</span> <span class="o">=</span> <span class="s2">&quot;matlab_3d&quot;</span>
    <span class="n">PENDULUM</span> <span class="o">=</span> <span class="s2">&quot;pendulum&quot;</span></div>



<div class="viewcode-block" id="EngineStatus">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineStatus">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EngineStatus</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Engine status types.&quot;&quot;&quot;</span>

    <span class="n">AVAILABLE</span> <span class="o">=</span> <span class="s2">&quot;available&quot;</span>
    <span class="n">UNAVAILABLE</span> <span class="o">=</span> <span class="s2">&quot;unavailable&quot;</span>
    <span class="n">LOADING</span> <span class="o">=</span> <span class="s2">&quot;loading&quot;</span>
    <span class="n">LOADED</span> <span class="o">=</span> <span class="s2">&quot;loaded&quot;</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span></div>



<div class="viewcode-block" id="EngineManager">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">EngineManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages different physics engines for golf swing modeling.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suite_root</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the engine manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            suite_root: Root directory of the Golf Modeling Suite</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">suite_root</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">suite_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">suite_root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span> <span class="o">/</span> <span class="s2">&quot;engines&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_engine</span><span class="p">:</span> <span class="n">EngineType</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span><span class="p">:</span> <span class="n">PhysicsEngine</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">EngineType</span><span class="p">,</span> <span class="n">EngineStatus</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Define engine paths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MUJOCO</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;physics_engines&quot;</span> <span class="o">/</span> <span class="s2">&quot;mujoco&quot;</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">DRAKE</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;physics_engines&quot;</span> <span class="o">/</span> <span class="s2">&quot;drake&quot;</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PINOCCHIO</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;physics_engines&quot;</span> <span class="o">/</span> <span class="s2">&quot;pinocchio&quot;</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">OPENSIM</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;physics_engines&quot;</span> <span class="o">/</span> <span class="s2">&quot;opensim&quot;</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MYOSIM</span><span class="p">:</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;physics_engines&quot;</span> <span class="o">/</span> <span class="s2">&quot;myosim&quot;</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_2D</span><span class="p">:</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;Simscape_Multibody_Models&quot;</span> <span class="o">/</span> <span class="s2">&quot;2D_Golf_Model&quot;</span>
            <span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_3D</span><span class="p">:</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;Simscape_Multibody_Models&quot;</span> <span class="o">/</span> <span class="s2">&quot;3D_Golf_Model&quot;</span>
            <span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PENDULUM</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">engines_root</span> <span class="o">/</span> <span class="s2">&quot;pendulum_models&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Initialize engine probes</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.engine_probes</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
            <span class="n">DrakeProbe</span><span class="p">,</span>
            <span class="n">MatlabProbe</span><span class="p">,</span>
            <span class="n">MuJoCoProbe</span><span class="p">,</span>
            <span class="n">MyoSimProbe</span><span class="p">,</span>
            <span class="n">OpenSimProbe</span><span class="p">,</span>
            <span class="n">PendulumProbe</span><span class="p">,</span>
            <span class="n">PinocchioProbe</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">probes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MUJOCO</span><span class="p">:</span> <span class="n">MuJoCoProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">DRAKE</span><span class="p">:</span> <span class="n">DrakeProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PINOCCHIO</span><span class="p">:</span> <span class="n">PinocchioProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">OPENSIM</span><span class="p">:</span> <span class="n">OpenSimProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MYOSIM</span><span class="p">:</span> <span class="n">MyoSimProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PENDULUM</span><span class="p">:</span> <span class="n">PendulumProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_2D</span><span class="p">:</span> <span class="n">MatlabProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">,</span> <span class="n">is_3d</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_3D</span><span class="p">:</span> <span class="n">MatlabProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">,</span> <span class="n">is_3d</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">EngineType</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Initialize engine status (Discovery)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_discover_engines</span><span class="p">()</span>

        <span class="c1"># Engine storage (Legacy / Specifics)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mujoco_module</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mujoco_model_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_drake_module</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_drake_meshcat</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pinocchio_module</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_engine</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_model_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pendulum_model_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Plugin Registry (Mapping Type -&gt; Loader Function)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loaders</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MUJOCO</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_mujoco_engine</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">DRAKE</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_drake_engine</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PINOCCHIO</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_pinocchio_engine</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">OPENSIM</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_opensim_engine</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MYOSIM</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_myosim_engine</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_2D</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_matlab_engine</span><span class="p">(</span>
                <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_2D</span>
            <span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_3D</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_matlab_engine</span><span class="p">(</span>
                <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_3D</span>
            <span class="p">),</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PENDULUM</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_pendulum_engine</span><span class="p">,</span>
        <span class="p">}</span>

<div class="viewcode-block" id="EngineManager.get_active_physics_engine">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_active_physics_engine">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_active_physics_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PhysicsEngine</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the currently active PhysicsEngine instance.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span></div>


<div class="viewcode-block" id="EngineManager.get_available_engines">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_available_engines">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_available_engines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">EngineType</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get list of available engines.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of available engine types</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">engine</span>
            <span class="k">for</span> <span class="n">engine</span><span class="p">,</span> <span class="n">status</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">AVAILABLE</span>
        <span class="p">]</span></div>


<div class="viewcode-block" id="EngineManager.switch_engine">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.switch_engine">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">switch_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine_type</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Switch to a different physics engine.</span>

<span class="sd">        Args:</span>
<span class="sd">            engine_type: The engine to switch to</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if switch was successful, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">engine_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown engine type: </span><span class="si">{</span><span class="n">engine_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">!=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">AVAILABLE</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Engine </span><span class="si">{</span><span class="n">engine_type</span><span class="si">}</span><span class="s2"> is not available&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_load_engine</span><span class="p">(</span><span class="n">engine_type</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_engine</span> <span class="o">=</span> <span class="n">engine_type</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully switched to engine: </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="n">GolfModelingError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to switch to engine </span><span class="si">{</span><span class="n">engine_type</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">ERROR</span>
            <span class="k">return</span> <span class="kc">False</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_discover_engines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Discover available engines by checking their directories.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">engine_type</span><span class="p">,</span> <span class="n">engine_path</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_paths</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">engine_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">AVAILABLE</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Engine </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> is available at </span><span class="si">{</span><span class="n">engine_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">UNAVAILABLE</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Engine </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> not found at </span><span class="si">{</span><span class="n">engine_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine_type</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a specific engine using the plugin registry.</span>

<span class="sd">        Args:</span>
<span class="sd">            engine_type: The engine to load</span>

<span class="sd">        Raises:</span>
<span class="sd">            GolfModelingError: If engine loading fails</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading engine: </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">LOADING</span>

        <span class="c1"># Unload current engine logic if needed could go here</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">loader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loaders</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">engine_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">loader</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No loader defined for </span><span class="si">{</span><span class="n">engine_type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">loader</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">LOADED</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully loaded engine: </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">ERROR</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to load engine </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_mujoco_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load MuJoCo engine with full initialization.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. Run probe</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.engine_probes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MuJoCoProbe</span>

            <span class="n">probe</span> <span class="o">=</span> <span class="n">MuJoCoProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">probe</span><span class="o">.</span><span class="n">probe</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;MuJoCo not ready:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">diagnostic_message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Fix: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_fix_instructions</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1"># 2. Instantiate Interface</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">engines.physics_engines.mujoco.python.mujoco_humanoid_golf.physics_engine</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
                <span class="n">MuJoCoPhysicsEngine</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">engine</span> <span class="o">=</span> <span class="n">MuJoCoPhysicsEngine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="n">engine</span>

            <span class="kn">import</span><span class="w"> </span><span class="nn">mujoco</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_mujoco_module</span> <span class="o">=</span> <span class="n">mujoco</span>
            <span class="c1"># Optional: preload a default model or verify model directory?</span>
            <span class="n">model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_paths</span><span class="p">[</span><span class="n">EngineType</span><span class="o">.</span><span class="n">MUJOCO</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;assets&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_mujoco_model_dir</span> <span class="o">=</span> <span class="n">model_dir</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MuJoCo engine fully loaded and instantiation successful&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                <span class="s2">&quot;MuJoCo requirements not met. Install mujoco&gt;=3.2.3&quot;</span>
            <span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_drake_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load Drake engine with full initialization.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.engine_probes</span><span class="w"> </span><span class="kn">import</span> <span class="n">DrakeProbe</span>

            <span class="n">probe</span> <span class="o">=</span> <span class="n">DrakeProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">probe</span><span class="o">.</span><span class="n">probe</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Drake not ready:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">diagnostic_message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Fix: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_fix_instructions</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="kn">from</span><span class="w"> </span><span class="nn">engines.physics_engines.drake.python.drake_physics_engine</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
                <span class="n">DrakePhysicsEngine</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">engine</span> <span class="o">=</span> <span class="n">DrakePhysicsEngine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="n">engine</span>

            <span class="kn">import</span><span class="w"> </span><span class="nn">pydrake</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_drake_module</span> <span class="o">=</span> <span class="n">pydrake</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Drake engine fully loaded and instantiated&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="s2">&quot;Drake requirements not met.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_pinocchio_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load Pinocchio engine.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.engine_probes</span><span class="w"> </span><span class="kn">import</span> <span class="n">PinocchioProbe</span>

            <span class="n">probe</span> <span class="o">=</span> <span class="n">PinocchioProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">probe</span><span class="o">.</span><span class="n">probe</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Pinocchio not ready:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">diagnostic_message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Fix: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_fix_instructions</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="kn">from</span><span class="w"> </span><span class="nn">engines.physics_engines.pinocchio.python.pinocchio_physics_engine</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
                <span class="n">PinocchioPhysicsEngine</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">engine</span> <span class="o">=</span> <span class="n">PinocchioPhysicsEngine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="n">engine</span>

            <span class="kn">import</span><span class="w"> </span><span class="nn">pinocchio</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_pinocchio_module</span> <span class="o">=</span> <span class="n">pinocchio</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Pinocchio engine fully loaded and instantiated&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="s2">&quot;Pinocchio requirements not met.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_opensim_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load OpenSim engine.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading OpenSim engine...&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.engine_probes</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpenSimProbe</span>

            <span class="n">probe</span> <span class="o">=</span> <span class="n">OpenSimProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">probe</span><span class="o">.</span><span class="n">probe</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;OpenSim not ready:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">diagnostic_message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Fix: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_fix_instructions</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="kn">from</span><span class="w"> </span><span class="nn">engines.physics_engines.opensim.python.opensim_physics_engine</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
                <span class="n">OpenSimPhysicsEngine</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">engine</span> <span class="o">=</span> <span class="n">OpenSimPhysicsEngine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="n">engine</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;OpenSim engine loaded&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="s2">&quot;OpenSim requirements not met.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_myosim_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load MyoSim engine.&quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Loading MyoSim engine...&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.engine_probes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MyoSimProbe</span>

            <span class="n">probe</span> <span class="o">=</span> <span class="n">MyoSimProbe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suite_root</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">probe</span><span class="o">.</span><span class="n">probe</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;MyoSim not ready:</span><span class="se">\n</span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">diagnostic_message</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Fix: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">get_fix_instructions</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="kn">from</span><span class="w"> </span><span class="nn">engines.physics_engines.myosim.python.myosim_physics_engine</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
                <span class="n">MyoSimPhysicsEngine</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">engine</span> <span class="o">=</span> <span class="n">MyoSimPhysicsEngine</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="n">engine</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MyoSim engine loaded&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="s2">&quot;MyoSim requirements not met.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_matlab_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine_type</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load MATLAB engine type.&quot;&quot;&quot;</span>
        <span class="c1"># MATLAB doesn&#39;t have a PhysicsEngine wrapper yet, so active_physics_engine remains None?</span>
        <span class="c1"># Or we should wrap it eventually. For now, adhere to old logic but nullify active_physics_engine</span>
        <span class="c1"># since it doesn&#39;t support the protocol.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">matlab.engine</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting MATLAB Engine (this may take 30-60 seconds)...&quot;</span><span class="p">)</span>
            <span class="n">engine</span> <span class="o">=</span> <span class="n">matlab</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">start_matlab</span><span class="p">()</span>

            <span class="n">model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_paths</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">/</span> <span class="s2">&quot;matlab&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">model_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;MATLAB model directory not found: </span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="n">engine</span><span class="o">.</span><span class="n">addpath</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model_dir</span><span class="p">),</span> <span class="n">nargout</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_engine</span> <span class="o">=</span> <span class="n">engine</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_model_dir</span> <span class="o">=</span> <span class="n">model_dir</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MATLAB engine loaded for </span><span class="si">{</span><span class="n">engine_type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="s2">&quot;MATLAB Engine for Python not installed.&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_pendulum_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load pendulum models.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># No protocol wrapper yet</span>
        <span class="n">model_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_paths</span><span class="p">[</span><span class="n">EngineType</span><span class="o">.</span><span class="n">PENDULUM</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">GolfModelingError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Pendulum models not found: </span><span class="si">{</span><span class="n">model_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pendulum_model_dir</span> <span class="o">=</span> <span class="n">model_dir</span>

<div class="viewcode-block" id="EngineManager.cleanup">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.cleanup">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up loaded engines.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_engine</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_engine</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;MATLAB engine shut down&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error shutting down MATLAB: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_matlab_engine</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_drake_meshcat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_drake_meshcat</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">active_physics_engine</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_engine</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Engine cleanup complete&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="EngineManager.get_current_engine">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_current_engine">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_current_engine</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EngineType</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the currently active engine type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_engine</span></div>


<div class="viewcode-block" id="EngineManager.get_engine_status">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_engine_status">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_engine_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine_type</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EngineStatus</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get status of a specific engine.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">engine_type</span><span class="p">,</span> <span class="n">EngineStatus</span><span class="o">.</span><span class="n">UNAVAILABLE</span><span class="p">)</span></div>


<div class="viewcode-block" id="EngineManager.get_engine_info">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_engine_info">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_engine_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get information about all engines.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;current_engine&quot;</span><span class="p">:</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_engine</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_engine</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="p">),</span>
            <span class="s2">&quot;available_engines&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_available_engines</span><span class="p">()],</span>
            <span class="s2">&quot;engine_status&quot;</span><span class="p">:</span> <span class="p">{</span><span class="n">e</span><span class="o">.</span><span class="n">value</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="EngineManager.validate_engine_configuration">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.validate_engine_configuration">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate_engine_configuration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine_type</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate engine configuration.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">engine_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_status</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">base_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine_paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">engine_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">base_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">validation_paths</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MUJOCO</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">DRAKE</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PINOCCHIO</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">OPENSIM</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MYOSIM</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_2D</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;matlab&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">MATLAB_3D</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;matlab&quot;</span><span class="p">,</span>
            <span class="n">EngineType</span><span class="o">.</span><span class="n">PENDULUM</span><span class="p">:</span> <span class="n">base_path</span> <span class="o">/</span> <span class="s2">&quot;python&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">validation_path</span> <span class="o">=</span> <span class="n">validation_paths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">engine_type</span><span class="p">,</span> <span class="n">base_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">validation_path</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span></div>


<div class="viewcode-block" id="EngineManager.probe_all_engines">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.probe_all_engines">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">probe_all_engines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">EngineType</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Probe all engines for detailed readiness checks.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dictionary mapping engine types to probe results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">engine_type</span><span class="p">,</span> <span class="n">probe</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span><span class="p">[</span><span class="n">engine_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">probe</span><span class="o">.</span><span class="n">probe</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span></div>


<div class="viewcode-block" id="EngineManager.get_probe_result">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_probe_result">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_probe_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">engine_type</span><span class="p">:</span> <span class="n">EngineType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get probe result for a specific engine.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">probe_all_engines</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">engine_type</span><span class="p">)</span></div>


<div class="viewcode-block" id="EngineManager.get_diagnostic_report">
<a class="viewcode-back" href="../../../modules/shared.html#shared.python.engine_manager.EngineManager.get_diagnostic_report">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_diagnostic_report</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get human-readable diagnostic report for all engines.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Formatted diagnostic report</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">probe_all_engines</span><span class="p">()</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">,</span>
            <span class="s2">&quot;Golf Modeling Suite - Engine Readiness Report&quot;</span><span class="p">,</span>
            <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">_engine_type</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">probe_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">status_icon</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">status_icon</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">engine_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Status: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">version</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Version: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">missing_dependencies</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Missing: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">missing_dependencies</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">diagnostic_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">result</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">fix</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_fix_instructions</span><span class="p">()</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   Fix: </span><span class="si">{</span><span class="n">fix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Golf Modeling Suite Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>